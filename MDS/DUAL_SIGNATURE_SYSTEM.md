# ๐ ูุธุงู ุงูุชูููุนุงุช ุงูุซูุงุฆู ูุน Realtime

## โ ุฌููุน ุงููุดุงูู ุชู ุญููุง:

### **1. Badge ุงูุฅุดุนุงุฑุงุช ููุฃุฏูู** โ
- โ ุชู ุฅุตูุงุญ useEffect dependency
- โ Badge ูุนูู ุงูุขู ููุฃุฏูู
- โ Badge ูุนูู ููุดุฑูู
- โ Badge ูุนูู ููุนููู
- โ Realtime ุจุฏูู ูุดุงูู

### **2. ูุธุงู ุงูุชูููุนุงุช ุงูุซูุงุฆู** โ
- โ ุชูููุน ุงููุณุคูู
- โ ุชูููุน ุงูุนููู
- โ ุนุฑุถ ุงูุชูููุนุงุช ูุฌููุน ุงูุฃุทุฑุงู
- โ Realtime updates ููุชูููุนุงุช

### **3. ุงูุฅุดุนุงุฑุงุช ุนูุฏ ุงูุชูููุน** โ
- โ ุฅุดุนุงุฑ ููุนููู ุนูุฏ ุชูููุน ุงููุณุคูู
- โ ุฅุดุนุงุฑ ููุดุฑูู ุนูุฏ ุชูููุน ุงููุณุคูู
- โ ุฅุดุนุงุฑ ูููุณุคูู ุนูุฏ ุชูููุน ุงูุนููู
- โ ุฅุดุนุงุฑ ููุดุฑูู ุนูุฏ ุชูููุน ุงูุนููู
- โ Email notifications

---

## ๐ ุงููููุงุช ุงูุฌุฏูุฏุฉ:

### **1. lib/actions/contract-signatures.ts**:
```typescript
// Actions ููุชูููุนุงุช
- signContract() - ุชูููุน ุงูุนูุฏ
- getContractSignatureStatus() - ุฌูุจ ุญุงูุฉ ุงูุชูููุนุงุช
```

### **2. components/contracts/signature-pad.tsx**:
```typescript
// Component ููุชูููุน
- Canvas ููุฑุณู
- ุฒุฑ ูุณุญ
- ุฒุฑ ุชูููุน
- Touch support
```

### **3. components/contracts/signatures-display.tsx**:
```typescript
// Component ูุนุฑุถ ุงูุชูููุนุงุช
- ุนุฑุถ ุชูููุน ุงููุณุคูู
- ุนุฑุถ ุชูููุน ุงูุนููู
- Realtime updates
- ุญุงูุฉ ุงูุนูุฏ
```

### **4. app/contract/[token]/page.tsx**:
```typescript
// ุตูุญุฉ ุงูุนูุฏ ุงูุนุงูุฉ ููุนููู
- ุนุฑุถ ุงูุนูุฏ
- SignaturePad ููุนููู
- ุนุฑุถ ุงูุชูููุนุงุช
- Realtime monitor
```

---

## ๐จ ุงููููุงุช ุงูููุญุฏุซุฉ:

### **1. app/admin/contracts/[id]/page.tsx**:
```typescript
โ ุฅุถุงูุฉ SignaturePad ููุฃุฏูู
โ ุฅุถุงูุฉ SignaturesDisplay
โ ุฅุถุงูุฉ ContractRealtimeMonitor
```

### **2. app/affiliate/contracts/[id]/page.tsx**:
```typescript
โ ุฅุถุงูุฉ SignaturesDisplay
โ ุนุฑุถ ุงูุชูููุนุงุช ููุดุฑูู
```

### **3. components/admin/admin-nav.tsx**:
```typescript
โ ุฅุตูุงุญ useEffect dependency
โ Badge ูุนูู ุงูุขู
```

### **4. components/affiliate/affiliate-nav.tsx**:
```typescript
โ ุฅุตูุงุญ useEffect dependency
```

### **5. components/client/client-nav.tsx**:
```typescript
โ ุฅุตูุงุญ useEffect dependency
```

---

## ๐ฏ ููู ูุนูู ุงููุธุงู:

### **ุณููุงุฑูู 1: ุงููุณุคูู ูููุน ุฃููุงู**:
```
1. ุงูุฃุฏูู ููุชุญ ุงูุนูุฏ
   โ
2. ูุฑู SignaturePad
   โ
3. ูุฑุณู ุงูุชูููุน
   โ
4. ูุถุบุท "ุชูููุน"
   โ
5. ุงูุชูููุน ููุญูุธ ูู DB
   โ
6. workflow_status = "pending_client_signature"
   โ
7. Realtime ููุฑุณู UPDATE event
   โ
8. ุงูุดุฑูู (ุฅุฐุง ูุงุชุญ ุงูุนูุฏ) ูุดูู ุงูุชูููุน ููุฑุงู โก
   โ
9. ุงูุนููู (ุฅุฐุง ูุงุชุญ ุงูุนูุฏ) ูุดูู ุงูุชูููุน ููุฑุงู โก
   โ
10. ุฅุดุนุงุฑ ููุนููู: "ุชู ุชูููุน ุงูุนูุฏ ูู ุงููุณุคูู - ุงูุขู ูู ุงูุชุธุงุฑ ุชูููุนู"
    โ
11. ุฅุดุนุงุฑ ููุดุฑูู: "ุชู ุชูููุน ุงูุนูุฏ ูู ุงููุณุคูู - ูู ุงูุชุธุงุฑ ุชูููุน ุงูุนููู"
    โ
12. Email ููุนููู
```

### **ุณููุงุฑูู 2: ุงูุนููู ูููุน ุซุงููุงู**:
```
1. ุงูุนููู ููุชุญ ุงูุนูุฏ (ุนุจุฑ ุงูุฑุงุจุท)
   โ
2. ูุฑู ุชูููุน ุงููุณุคูู โ
   โ
3. ูุฑู SignaturePad ูุชูููุนู
   โ
4. ูุฑุณู ุงูุชูููุน
   โ
5. ูุถุบุท "ุชูููุน"
   โ
6. ุงูุชูููุน ููุญูุธ ูู DB
   โ
7. workflow_status = "completed" โ
   โ
8. status = "active" โ
   โ
9. Realtime ููุฑุณู UPDATE event
   โ
10. ุงูุฃุฏูู (ุฅุฐุง ูุงุชุญ ุงูุนูุฏ) ูุดูู ุงูุชูููุน ููุฑุงู โก
    โ
11. ุงูุดุฑูู (ุฅุฐุง ูุงุชุญ ุงูุนูุฏ) ูุดูู ุงูุชูููุน ููุฑุงู โก
    โ
12. ุฅุดุนุงุฑ ููุฃุฏูู: "ุชู ุชูููุน ุงูุนูุฏ ูู ุงูุนููู - ุงูุนูุฏ ููุชูู ููุดุท"
    โ
13. ุฅุดุนุงุฑ ููุดุฑูู: "ุชู ุชูููุน ุงูุนูุฏ ูู ุงูุนููู - ุงูุนูุฏ ููุชูู ููุดุท"
    โ
14. Toast ููุฃุฏูู ูุงูุดุฑูู: "โ ุงูุนูุฏ ููุชูู ููุดุท ุงูุขู"
```

### **ุณููุงุฑูู 3: ุงูุนููู ูููุน ุฃููุงู**:
```
1. ุงูุนููู ููุชุญ ุงูุนูุฏ
   โ
2. ูุฑู SignaturePad
   โ
3. ูููุน
   โ
4. workflow_status = "pending_admin_signature"
   โ
5. ุฅุดุนุงุฑ ููุฃุฏูู: "ุชู ุชูููุน ุงูุนูุฏ ูู ุงูุนููู - ูู ุงูุชุธุงุฑ ุชูููุนู"
   โ
6. ุฅุดุนุงุฑ ููุดุฑูู: "ุชู ุชูููุน ุงูุนูุฏ ูู ุงูุนููู - ูู ุงูุชุธุงุฑ ุชูููุน ุงููุณุคูู"
   โ
7. ุงูุฃุฏูู ูููุน
   โ
8. workflow_status = "completed" โ
   โ
9. ุงูุฌููุน ูุดูู ุงูุชูููุนุงุช ูู Realtime โก
```

---

## โก Realtime Events:

### **ุฌุฏูู contracts**:
```typescript
channel: "contract-signatures-${contractId}"
event: UPDATE
filter: id=eq.${contractId}

// ุนูุฏ UPDATE:
1. Fetch updated signature data
2. Update SignaturesDisplay
3. Show toast if completed
4. Update UI instantly โก
```

---

## ๐จ UI Components:

### **SignaturePad**:
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ุชูููุน ุงููุณุคูู / ุชูููุน ุงูุนููู           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ โ                                     โ โ
โ โ     [Canvas ููุฑุณู]                  โ โ
โ โ                                     โ โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ                                         โ
โ [ูุณุญ]                      [ุชูููุน]     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### **SignaturesDisplay**:
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ุญุงูุฉ ุงูุชูููุนุงุช          [โ ููุชูู]     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ     โ
โ โ ุชูููุน ุงููุณุคููโ  โ ุชูููุน ุงูุนููู โ     โ
โ โ      โ      โ  โ      โ      โ     โ
โ โ [ุตูุฑุฉ ุงูุชูููุน]โ  โ [ุตูุฑุฉ ุงูุชูููุน]โ     โ
โ โ ุงููููุน: ุฃุญูุฏ โ  โ ุงููููุน: ูุญูุฏ โ     โ
โ โ ุงูุชุงุฑูุฎ: ... โ  โ ุงูุชุงุฑูุฎ: ... โ     โ
โ โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ     โ
โ                                         โ
โ โ ุชู ุชูููุน ุงูุนูุฏ ูู ุฌููุน ุงูุฃุทุฑุงู      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### **ุญุงูุงุช ูุฎุชููุฉ**:
```
// ูุง ุชูููุนุงุช:
โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ
โ โณ ูู ุงูุชุธุงุฑ โ  โ โณ ูู ุงูุชุธุงุฑ โ
โ ุชูููุน ุงููุณุคููโ  โ ุชูููุน ุงูุนููู โ
โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ

// ุชูููุน ูุงุญุฏ ููุท:
โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ
โ โ ุชู ุงูุชูููุนโ  โ โณ ูู ุงูุชุธุงุฑ โ
โ [ุตูุฑุฉ]       โ  โ ุชูููุน ุงูุนููู โ
โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ

// ุงูุชูููุนุงู:
โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ
โ โ ุชู ุงูุชูููุนโ  โ โ ุชู ุงูุชูููุนโ
โ [ุตูุฑุฉ]       โ  โ [ุตูุฑุฉ]       โ
โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ
```

---

## ๐ Database Schema:

### **ุฌุฏูู contracts**:
```sql
admin_signature_data TEXT,        -- Base64 image
admin_signature_date TIMESTAMPTZ,
admin_signed_by UUID,             -- FK to users
client_signature_data TEXT,       -- Base64 image
client_signature_date TIMESTAMPTZ,
workflow_status TEXT              -- 'pending_admin_signature', 
                                  -- 'pending_client_signature', 
                                  -- 'completed'
```

---

## ๐ ุงูุฅุดุนุงุฑุงุช:

### **ุนูุฏ ุชูููุน ุงููุณุคูู**:
```
โ ููุนููู:
   ุงูุนููุงู: "โ ุชู ุชูููุน ุงูุนูุฏ ูู ุงููุณุคูู"
   ุงูุฑุณุงูุฉ: "ุงูุขู ูู ุงูุชุธุงุฑ ุชูููุนู ููุนูุฏ"
   Link: /contract/{token}

โ ููุดุฑูู:
   ุงูุนููุงู: "โ ุชู ุชูููุน ุงูุนูุฏ ูู ุงููุณุคูู"
   ุงูุฑุณุงูุฉ: "ูู ุงูุชุธุงุฑ ุชูููุน ุงูุนููู"
   Link: /affiliate/contracts/{id}
```

### **ุนูุฏ ุชูููุน ุงูุนููู**:
```
โ ููุฃุฏูู:
   ุงูุนููุงู: "โ ุชู ุชูููุน ุงูุนูุฏ ูู ุงูุนููู"
   ุงูุฑุณุงูุฉ: "ุงูุนูุฏ ููุชูู ููุดุท ุงูุขู" (ุฅุฐุง ุงูุฃุฏูู ููุน)
            ุฃู "ูู ุงูุชุธุงุฑ ุชูููุนู" (ุฅุฐุง ูู ูููุน)
   Link: /admin/contracts/{id}

โ ููุดุฑูู:
   ุงูุนููุงู: "โ ุชู ุชูููุน ุงูุนูุฏ ูู ุงูุนููู"
   ุงูุฑุณุงูุฉ: "ุงูุนูุฏ ููุชูู ููุดุท ุงูุขู" (ุฅุฐุง ุงูุฃุฏูู ููุน)
            ุฃู "ูู ุงูุชุธุงุฑ ุชูููุน ุงููุณุคูู" (ุฅุฐุง ูู ูููุน)
   Link: /affiliate/contracts/{id}
```

---

## โ ุงูุงุฎุชุจุงุฑ:

### **1. ุงุฎุชุจุฑ ุชูููุน ุงููุณุคูู**:
```
1. ุชุงุจ 1: ุฃุฏูู ููุชุญ ุนูุฏ
2. ุชุงุจ 2: ุดุฑูู ููุชุญ ููุณ ุงูุนูุฏ
3. ุชุงุจ 3: ุนููู ููุชุญ ุงูุนูุฏ (ุนุจุฑ ุงูุฑุงุจุท)
4. ุชุงุจ 1: ุงูุฃุฏูู ูููุน
5. ุชุงุจ 2 ู 3: ูุฌุจ ุฃู ูุธูุฑ ุงูุชูููุน ููุฑุงู โก
6. ุชุงุจ 2 ู 3: ูุฌุจ ุฃู ูุตู ุฅุดุนุงุฑ โก
```

### **2. ุงุฎุชุจุฑ ุชูููุน ุงูุนููู**:
```
1. ุชุงุจ 1: ุนููู ููุชุญ ุงูุนูุฏ
2. ุชุงุจ 2: ุฃุฏูู ููุชุญ ุงูุนูุฏ
3. ุชุงุจ 3: ุดุฑูู ููุชุญ ุงูุนูุฏ
4. ุชุงุจ 1: ุงูุนููู ูููุน
5. ุชุงุจ 2 ู 3: ูุฌุจ ุฃู ูุธูุฑ ุงูุชูููุน ููุฑุงู โก
6. ุชุงุจ 2 ู 3: ูุฌุจ ุฃู ูุตู ุฅุดุนุงุฑ โก
```

### **3. ุงุฎุชุจุฑ ุงูุนูุฏ ุงูููุชูู**:
```
1. ุงูุฃุฏูู ูููุน
2. ุงูุนููู ูููุน
3. workflow_status = "completed" โ
4. status = "active" โ
5. ุงูุฌููุน ูุดูู ุงูุชูููุนุงุช โก
6. ุฑุณุงูุฉ: "โ ุชู ุชูููุน ุงูุนูุฏ ูู ุฌููุน ุงูุฃุทุฑุงู"
```

### **4. ุงุฎุชุจุฑ Badge ุงูุฅุดุนุงุฑุงุช**:
```
1. ุชุงุจ 1: ุฃุฏูู ูู dashboard
2. ุชุงุจ 2: ุดุฑูู ูููุน ุนูุฏ
3. ุชุงุจ 1: Badge ูุธูุฑ ููุฑุงู โก
4. ุชุงุจ 1: ููุชุญ ุงูุฅุดุนุงุฑุงุช
5. ูุดูู ุงูุฅุดุนุงุฑ
6. Badge ูุชุญุฏุซ โก
```

---

## ๐ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ:

**ูู ุดูุก ูุนูู ุจุดูู ุงุญุชุฑุงูู**:
- โ Badge ุงูุฅุดุนุงุฑุงุช ูุนูู ููุฌููุน
- โ ูุธุงู ุชูููุนุงุช ุซูุงุฆู
- โ Realtime updates ููุชูููุนุงุช
- โ ุฅุดุนุงุฑุงุช ุนูุฏ ูู ุชูููุน
- โ Email notifications
- โ UI ุฌููู ูููุธู
- โ Touch support ููููุจุงูู
- โ Clean code
- โ Performance ูุญุณู

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ:

### **ููุงุฎุชุจุงุฑ**:
```bash
1. npm run dev
2. ุงูุชุญ 3 tabs:
   - Tab 1: Admin (/admin/contracts/[id])
   - Tab 2: Affiliate (/affiliate/contracts/[id])
   - Tab 3: Client (/contract/[token])
3. ุฌุฑุจ ุงูุชูููุน ูู ุงูุฃุฏูู
4. ุดูู ุงูุชูููุน ูุธูุฑ ูู Realtime ููุฌููุน โก
5. ุฌุฑุจ ุงูุชูููุน ูู ุงูุนููู
6. ุดูู ุงูุนูุฏ ููุชูู โก
```

---

**ุงููุธุงู ุฌุงูุฒ ููุฅูุชุงุฌ! ๐๐**

**ุฌููุน ุงูุณููุงุฑูููุงุช ูุบุทุงุฉ:**
- โ ุงููุณุคูู ูููุน ุฃููุงู
- โ ุงูุนููู ูููุน ุฃููุงู
- โ ุงูุชูููุนุงู ูุนุงู
- โ Realtime ููุฌููุน
- โ ุฅุดุนุงุฑุงุช ููุฌููุน
- โ Badge ูุนูู
- โ Clean code

**ูู ุดูุก ูุชุฒุงูู ูู ุงูููุช ุงููุนูู! โก๐**
